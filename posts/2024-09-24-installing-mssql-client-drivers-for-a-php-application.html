<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width, initial-scale=1"/><meta charSet="utf-8"/><title>Installing MSSQL Client Drivers for a PHP Application | Garrit&#x27;s Notes</title><meta name="Description" content="Generalist software developer writing about scalable infrastructure, fullstack development and DevOps practices."/><link rel="icon" type="image/svg+xml" href="/favicon.svg"/><link rel="manifest" href="/site.webmanifest"/><link rel="webmention" href="https://webmention.io/garrit.xyz/webmention"/><link rel="pingback" href="https://webmention.io/garrit.xyz/xmlrpc"/><meta name="next-head-count" content="8"/><link rel="preload" href="/_next/static/css/935debb317df188e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/935debb317df188e.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-144ddb6b9c2105c7.js" defer=""></script><script src="/_next/static/chunks/main-9aba655ce0bf5282.js" defer=""></script><script src="/_next/static/chunks/pages/_app-5d4795abae9e13c0.js" defer=""></script><script src="/_next/static/chunks/630-15567ca4e241c039.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bpost%5D-276741fc94169dfe.js" defer=""></script><script src="/_next/static/MNSXUoEKTbVnv4jgMFVNx/_buildManifest.js" defer=""></script><script src="/_next/static/MNSXUoEKTbVnv4jgMFVNx/_ssgManifest.js" defer=""></script></head><body><div id="__next"><section class="layout"><header class="header"><nav class="nav" role="navigation" aria-label="main navigation"><div class="header__container"><a href="/" class="header__container__logo">Garrit&#x27;s Notes</a></div><ul class="header__links"><li><a href="/posts">Blog</a></li><li><a href="/contact">Contact</a></li><li><a href="/links">More ...</a></li></ul></nav></header><div class="content"><article class="page h-entry"><div class="page__info"><h1 class="p-name">Installing MSSQL Client Drivers for a PHP Application</h1><time class="page__info__date">Sep 24 2024</time><p class="tag-list"><a href="/posts?tags=guide">#<!-- -->guide</a><a href="/posts?tags=note">#<!-- -->note</a><a href="/posts?tags=web">#<!-- -->web</a><a href="/posts?tags=tech">#<!-- -->tech</a><a href="/posts?tags=programming">#<!-- -->programming</a><a href="/posts?tags=php">#<!-- -->php</a></p></div><div class="page__body e-content"><p>I just had the pleasure (<em>cough</em>) to connect an <a href="https://de.wikipedia.org/wiki/Microsoft_SQL_Server">MSSQL</a> database to a <a href="https://laravel.com/">Laravel</a> application at work. Because the process was <em>super</em> tedious, I wanted to quickly jot this down so I will never have to go through this again.</p>
<h2 id="our-setup">Our setup</h2>
<p>We&#x27;re building a Laravel application with <a href="https://ddev.com/">DDEV</a>. DDEV essentially moves all development tools into Docker containers and adds some nice features like local database management.</p>
<h2 id="the-process">The process</h2>
<p>Laravel comes with the boilerplate to use MSSQL out of the box. In your app, just set the database config to use <code>sqlsrv</code>:</p>
<pre><code class="language-php">    &#x27;connections&#x27; =&gt; [
        &#x27;sqlsrv&#x27; =&gt; [
            &#x27;driver&#x27; =&gt; &#x27;sqlsrv&#x27;,
            &#x27;url&#x27; =&gt; env(&#x27;DB_URL&#x27;),
            &#x27;host&#x27; =&gt; env(&#x27;DB_HOST&#x27;, &#x27;127.0.0.1&#x27;),
            &#x27;port&#x27; =&gt; env(&#x27;DB_PORT&#x27;, &#x27;1433&#x27;),
            &#x27;database&#x27; =&gt; env(&#x27;DB_DATABASE&#x27;, &#x27;laravel&#x27;),
            &#x27;username&#x27; =&gt; env(&#x27;DB_USERNAME&#x27;, &#x27;root&#x27;),
            &#x27;password&#x27; =&gt; env(&#x27;DB_PASSWORD&#x27;, &#x27;&#x27;),
            &#x27;unix_socket&#x27; =&gt; env(&#x27;DB_SOCKET&#x27;, &#x27;&#x27;),
            &#x27;charset&#x27; =&gt; env(&#x27;DB_CHARSET&#x27;, &#x27;utf8&#x27;),
            &#x27;prefix&#x27; =&gt; &#x27;&#x27;,
            &#x27;prefix_indexes&#x27; =&gt; true,
            // &#x27;encrypt&#x27; =&gt; env(&#x27;DB_ENCRYPT&#x27;, &#x27;yes&#x27;),
            // &#x27;trust_server_certificate&#x27; =&gt; env(&#x27;DB_TRUST_SERVER_CERTIFICATE&#x27;, &#x27;false&#x27;),
        ],
    ],
</code></pre>
<p>You will see errors when starting your app, because you need to install the corresponding drivers first. Instead of adding them through <a href="https://getcomposer.org/">Composer</a> (a widely adopted package manager for PHP), you have to install the ODBC drivers <strong>through the system package manager</strong>, because Microsoft doesn&#x27;t maintain a PHP package. Furthermore, you also have to install the driver repository because <strong>Microsoft doesn&#x27;t even maintain packages for the major Linux distributions</strong>. In our setup with DDEV, this has to be done by amending the Dockerfile used for the application container. Create a file at <code>.ddev/web-build/Dockerfile</code> and add the following contents:</p>
<pre><code class="language-dockerfile"># https://ddev.readthedocs.io/en/stable/users/extend/customizing-images/#adding-extra-dockerfiles-for-webimage-and-dbimage
# https://stackoverflow.com/questions/58086933/how-to-install-the-sql-server-php-drivers-in-ddev-local#new-answer
ARG BASE_IMAGE
FROM $BASE_IMAGE

RUN npm install --global forever
RUN echo &quot;Built on $(date)&quot; &gt; /build-date.txt

# RUN curl https://packages.microsoft.com/keys/microsoft.asc | sudo apt-key add -
# RUN curl https://packages.microsoft.com/config/debian/11/prod.list &gt; /etc/apt/sources.list.d/mssql-release.list

RUN curl -fsSL https://packages.microsoft.com/keys/microsoft.asc | sudo gpg --dearmor -o /usr/share/keyrings/microsoft-prod.gpg
RUN curl https://packages.microsoft.com/config/debian/12/prod.list | sudo tee /etc/apt/sources.list.d/mssql-release.list

RUN apt-get update
RUN apt-get --allow-downgrades -y install libssl-dev
RUN apt-get -y update &amp;&amp; yes | ACCEPT_EULA=Y apt-get -y install php8.3-dev php-pear unixodbc-dev htop
RUN ACCEPT_EULA=Y apt-get -y install msodbcsql18 mssql-tools18
RUN sudo pecl channel-update pecl.php.net
RUN sudo pecl install sqlsrv
RUN sudo pecl install pdo_sqlsrv

RUN sudo printf &quot;; priority=20\nextension=sqlsrv.so\n&quot; &gt; /etc/php/8.3/mods-available/sqlsrv.ini
RUN sudo printf &quot;; priority=30\nextension=pdo_sqlsrv.so\n&quot; &gt; /etc/php/8.3/mods-available/pdo_sqlsrv.ini
RUN sudo phpenmod -v 8.3 -s cli sqlsrv pdo_sqlsrv
RUN sudo phpenmod -v 8.3 -s fpm sqlsrv pdo_sqlsrv
RUN sudo phpenmod -v 8.3 -s apache2 sqlsrv pdo_sqlsrv

RUN sudo printf &quot;; priority=20\nextension=sqlsrv.so\n&quot; &gt; /etc/php/8.3/mods-available/sqlsrv.ini
RUN sudo printf &quot;; priority=30\nextension=pdo_sqlsrv.so\n&quot; &gt; /etc/php/8.3/mods-available/pdo_sqlsrv.ini
RUN sudo phpenmod -v 8.3 -s cli sqlsrv pdo_sqlsrv
RUN sudo phpenmod -v 8.3 -s fpm sqlsrv pdo_sqlsrv
RUN sudo phpenmod -v 8.3 -s apache2 sqlsrv pdo_sqlsrv

RUN echo &#x27;export PATH=&quot;$PATH:/opt/mssql-tools/bin&quot;&#x27; &gt;&gt; ~/.bash_profile
</code></pre>
<p>If you&#x27;re reading this in the future and Microsoft may have released a new version of the ODBC drivers, you may have to follow the new <a href="https://learn.microsoft.com/de-de/sql/connect/odbc/linux-mac/installing-the-microsoft-odbc-driver-for-sql-server?view=sql-server-ver16&amp;tabs=debian18-install%2Calpine17-install%2Cdebian8-install%2Credhat7-13-install%2Crhel7-offline#18">installation instructions from their documentation</a>. It took me a while to realize that I couldn&#x27;t install version 17 of the driver because I was using the installation instructions for version 18. They are apparently incompatible with each other.</p>
<p>I hope that you&#x27;ll never have to touch the shithole that is MSSQL, but if you do, I hope that this guide will be of value to you.</p><p class="horizontal-list"><button>üíåÔ∏è Reply via E-Mail</button><button>üîó Share</button><button>‚úèÔ∏è Fix Typo</button></p><hr/><h2>Continue Reading</h2><div><div class="blog__list__post"><time class="blog__list__post__date">Sep 15 2025</time><br/><a href="/posts/2025-09-15-making-family-it-support-effortless-and-free">Making family IT support effortless (and free)</a></div><div class="blog__list__post"><time class="blog__list__post__date">Jun 11 2025</time><br/><a href="/posts/2025-06-11-git-diff-ignore-all-space-makes-code-reviews-way-easier">git diff --ignore-all-space makes code review way easier</a></div><div class="blog__list__post"><time class="blog__list__post__date">May 20 2025</time><br/><a href="/posts/2025-05-20-no-matter-what-you-do-always-leave-a-breadcrumb">No matter what you do, always leave a breadcrumb</a></div><div class="blog__list__post"><time class="blog__list__post__date">Mar 25 2025</time><br/><a href="/posts/2025-03-25-container-interfaces">About Container Interfaces</a></div><div class="blog__list__post"><time class="blog__list__post__date">Feb 27 2025</time><br/><a href="/posts/2025-02-27-a-trick-to-manage-frequently-used-prompts-in-claude-chatgpt">A trick to manage frequently used prompts in Claude/ChatGPT</a></div></div></div></article></div><footer class="footer"><div class="notice"><p>I invite you to read my new book<!-- --> <a target="_blank" href="https://www.buymeacoffee.com/garrit/e/233695">Five Years of Blogging: Ideas, Opinions and Guides written 2019 to 2024</a>. Becoming a member on<!-- --> <a target="_blank" href="https://www.buymeacoffee.com/garrit">Buy Me a Coffee</a> <!-- -->will grant you free access to the book!</p><a href="https://www.buymeacoffee.com/garrit/extras"><img src="/assets/five-years-of-blogging-cover-3d.png" alt="Cover of Five Years of Blogging" loading="lazy"/></a></div><div class="footer__content"><h3>Links of Interest</h3><a href="/rss.xml">RSS Feed</a><br/><a href="/todo">Todo List</a><br/><a href="https://keys.openpgp.org/vks/v1/by-fingerprint/2218337E54AA1DBE207B404DBB54AF7EB0939F3D">PGP Key</a><br/><a href="/guestbook">Guestbook</a><br/><a href="/blogroll">Blogroll</a><br/><a href="/ctf">Capture the Flag</a><h3>Elsewhere</h3><a href="https://github.com/garritfra" rel="me">Github</a><br/><a href="https://www.linkedin.com/in/garritfranke/">LinkedIn</a><br/><a href="https://fosstodon.org/@garritfra">Mastodon (ActivityPub)</a><br/><a href="/contact">Contact</a></div><a href="https://www.buymeacoffee.com/garrit" target="_blank"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a tea&amp;emoji=&amp;slug=garrit&amp;button_colour=FFB300&amp;font_colour=000000&amp;font_family=Cookie&amp;outline_colour=000000&amp;coffee_colour=ffffff"/></a><p>üëª Proud member of<!-- --> <a target="_blank" href="https://darktheme.club/">darktheme.club</a> <!-- -->üëª</p><p>¬© 2018-<!-- -->2025<!-- --> Garrit Franke<br/><a href="/privacy">Privacy</a> |<!-- --> <a target="_blank" href="https://github.com/garritfra/garrit.xyz">Source Code</a></p></footer></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"2024-09-24-installing-mssql-client-drivers-for-a-php-application","markdownBody":"\nI just had the pleasure (*cough*) to connect an [MSSQL](https://de.wikipedia.org/wiki/Microsoft_SQL_Server) database to a [Laravel](https://laravel.com/) application at work. Because the process was *super* tedious, I wanted to quickly jot this down so I will never have to go through this again.\r\n\r\n## Our setup\r\n\r\nWe're building a Laravel application with [DDEV](https://ddev.com/). DDEV essentially moves all development tools into Docker containers and adds some nice features like local database management.\r\n\r\n## The process\r\n\r\nLaravel comes with the boilerplate to use MSSQL out of the box. In your app, just set the database config to use `sqlsrv`:\r\n\r\n```php\r\n    'connections' =\u003e [\r\n        'sqlsrv' =\u003e [\r\n            'driver' =\u003e 'sqlsrv',\r\n            'url' =\u003e env('DB_URL'),\r\n            'host' =\u003e env('DB_HOST', '127.0.0.1'),\r\n            'port' =\u003e env('DB_PORT', '1433'),\r\n            'database' =\u003e env('DB_DATABASE', 'laravel'),\r\n            'username' =\u003e env('DB_USERNAME', 'root'),\r\n            'password' =\u003e env('DB_PASSWORD', ''),\r\n            'unix_socket' =\u003e env('DB_SOCKET', ''),\r\n            'charset' =\u003e env('DB_CHARSET', 'utf8'),\r\n            'prefix' =\u003e '',\r\n            'prefix_indexes' =\u003e true,\r\n            // 'encrypt' =\u003e env('DB_ENCRYPT', 'yes'),\r\n            // 'trust_server_certificate' =\u003e env('DB_TRUST_SERVER_CERTIFICATE', 'false'),\r\n        ],\r\n    ],\r\n```\r\n\r\nYou will see errors when starting your app, because you need to install the corresponding drivers first. Instead of adding them through [Composer](https://getcomposer.org/) (a widely adopted package manager for PHP), you have to install the ODBC drivers **through the system package manager**, because Microsoft doesn't maintain a PHP package. Furthermore, you also have to install the driver repository because **Microsoft doesn't even maintain packages for the major Linux distributions**. In our setup with DDEV, this has to be done by amending the Dockerfile used for the application container. Create a file at `.ddev/web-build/Dockerfile` and add the following contents:\r\n\r\n```dockerfile\r\n# https://ddev.readthedocs.io/en/stable/users/extend/customizing-images/#adding-extra-dockerfiles-for-webimage-and-dbimage\r\n# https://stackoverflow.com/questions/58086933/how-to-install-the-sql-server-php-drivers-in-ddev-local#new-answer\r\nARG BASE_IMAGE\r\nFROM $BASE_IMAGE\r\n\r\nRUN npm install --global forever\r\nRUN echo \"Built on $(date)\" \u003e /build-date.txt\r\n\r\n# RUN curl https://packages.microsoft.com/keys/microsoft.asc | sudo apt-key add -\r\n# RUN curl https://packages.microsoft.com/config/debian/11/prod.list \u003e /etc/apt/sources.list.d/mssql-release.list\r\n\r\nRUN curl -fsSL https://packages.microsoft.com/keys/microsoft.asc | sudo gpg --dearmor -o /usr/share/keyrings/microsoft-prod.gpg\r\nRUN curl https://packages.microsoft.com/config/debian/12/prod.list | sudo tee /etc/apt/sources.list.d/mssql-release.list\r\n\r\nRUN apt-get update\r\nRUN apt-get --allow-downgrades -y install libssl-dev\r\nRUN apt-get -y update \u0026\u0026 yes | ACCEPT_EULA=Y apt-get -y install php8.3-dev php-pear unixodbc-dev htop\r\nRUN ACCEPT_EULA=Y apt-get -y install msodbcsql18 mssql-tools18\r\nRUN sudo pecl channel-update pecl.php.net\r\nRUN sudo pecl install sqlsrv\r\nRUN sudo pecl install pdo_sqlsrv\r\n\r\nRUN sudo printf \"; priority=20\\nextension=sqlsrv.so\\n\" \u003e /etc/php/8.3/mods-available/sqlsrv.ini\r\nRUN sudo printf \"; priority=30\\nextension=pdo_sqlsrv.so\\n\" \u003e /etc/php/8.3/mods-available/pdo_sqlsrv.ini\r\nRUN sudo phpenmod -v 8.3 -s cli sqlsrv pdo_sqlsrv\r\nRUN sudo phpenmod -v 8.3 -s fpm sqlsrv pdo_sqlsrv\r\nRUN sudo phpenmod -v 8.3 -s apache2 sqlsrv pdo_sqlsrv\r\n\r\nRUN sudo printf \"; priority=20\\nextension=sqlsrv.so\\n\" \u003e /etc/php/8.3/mods-available/sqlsrv.ini\r\nRUN sudo printf \"; priority=30\\nextension=pdo_sqlsrv.so\\n\" \u003e /etc/php/8.3/mods-available/pdo_sqlsrv.ini\r\nRUN sudo phpenmod -v 8.3 -s cli sqlsrv pdo_sqlsrv\r\nRUN sudo phpenmod -v 8.3 -s fpm sqlsrv pdo_sqlsrv\r\nRUN sudo phpenmod -v 8.3 -s apache2 sqlsrv pdo_sqlsrv\r\n\r\nRUN echo 'export PATH=\"$PATH:/opt/mssql-tools/bin\"' \u003e\u003e ~/.bash_profile\r\n```\r\n\r\nIf you're reading this in the future and Microsoft may have released a new version of the ODBC drivers, you may have to follow the new [installation instructions from their documentation](https://learn.microsoft.com/de-de/sql/connect/odbc/linux-mac/installing-the-microsoft-odbc-driver-for-sql-server?view=sql-server-ver16\u0026tabs=debian18-install%2Calpine17-install%2Cdebian8-install%2Credhat7-13-install%2Crhel7-offline#18). It took me a while to realize that I couldn't install version 17 of the driver because I was using the installation instructions for version 18. They are apparently incompatible with each other.\r\n\r\nI hope that you'll never have to touch the shithole that is MSSQL, but if you do, I hope that this guide will be of value to you.\n","frontmatter":{"title":"Installing MSSQL Client Drivers for a PHP Application","date":"2024-09-24","tags":"guide, note, web, tech, programming, php"},"tags":["guide","note","web","tech","programming","php"]},"recommendedPosts":[{"slug":"2025-09-15-making-family-it-support-effortless-and-free","frontmatter":{"title":"Making family IT support effortless (and free)","date":"2025-09-15","tags":"note, life, tech"},"tags":["note","life","tech"]},{"slug":"2025-06-11-git-diff-ignore-all-space-makes-code-reviews-way-easier","frontmatter":{"title":"git diff --ignore-all-space makes code review way easier","date":"2025-06-11","tags":"guide, note, til, git, tech, programming"},"tags":["guide","note","til","git","tech","programming"]},{"slug":"2025-05-20-no-matter-what-you-do-always-leave-a-breadcrumb","frontmatter":{"title":"No matter what you do, always leave a breadcrumb","date":"2025-05-20","tags":"note, practices, writing, life, tech"},"tags":["note","practices","writing","life","tech"]},{"slug":"2025-03-25-container-interfaces","frontmatter":{"title":"About Container Interfaces","date":"2025-03-25","tags":"infrastructure, note, tech"},"tags":["infrastructure","note","tech"]},{"slug":"2025-02-27-a-trick-to-manage-frequently-used-prompts-in-claude-chatgpt","frontmatter":{"title":"A trick to manage frequently used prompts in Claude/ChatGPT","date":"2025-02-27","tags":"guide, note, tech, llm, ai"},"tags":["guide","note","tech","llm","ai"]}]},"__N_SSG":true},"page":"/posts/[post]","query":{"post":"2024-09-24-installing-mssql-client-drivers-for-a-php-application"},"buildId":"MNSXUoEKTbVnv4jgMFVNx","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>